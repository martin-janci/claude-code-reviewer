services:
  reviewer:
    build: .
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - WEBHOOK_SECRET=${WEBHOOK_SECRET:-}
    volumes:
      # NOTE: claude-auth is a named volume for persisting auth state across restarts.
      # It shadows the COPY'd .claude/ from the image. If you update .claude/ files other
      # than skills, run: docker volume rm claude-code-reviewer_claude-auth
      - claude-auth:/home/node/.claude
      - ./.claude/skills:/home/node/.claude/skills:ro
      - ./config.yaml:/app/config.yaml:ro
      - reviewer-data:/app/data
    ports:
      - "3000:3000"
    restart: unless-stopped

volumes:
  claude-auth:
  reviewer-data:
